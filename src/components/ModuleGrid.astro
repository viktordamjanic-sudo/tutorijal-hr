---
// Module Grid Component
import { PREDEFINED_TASKS } from '../lib/constants';
import type { Task } from '../types';

interface TaskWithPath extends Task {
  path: string;
}

const tasksWithPaths: TaskWithPath[] = PREDEFINED_TASKS.map(task => ({
  ...task,
  path: `/modul/${task.id}`,
}));

const audienceStyles: Record<string, { bg: string; text: string; label: string }> = {
  kids: { bg: 'bg-[#8CFF98]', text: 'text-black', label: 'SYS_EDU' },
  seniors: { bg: 'bg-[#FFE5F1]', text: 'text-black', label: 'SYS_ACC' },
  all: { bg: 'bg-[#FFDF00]', text: 'text-black', label: 'SYS_GEN' },
};
---

<div id="moduli" class="grid md:grid-cols-2 lg:grid-cols-3 gap-8 py-8">
  {tasksWithPaths.map((task, index) => {
    const style = audienceStyles[task.targetAudience] || audienceStyles.all;
    
    return (
      <a
        href={task.path}
        class="group relative bg-white p-8 border-4 border-black shadow-[4px_4px_0px_#000] hover:shadow-[8px_8px_0px_#000] hover:-translate-y-2 hover:bg-[#F4F4F0] transition-all block flex flex-col h-full"
      >
        <div class="flex items-start justify-between mb-8 relative z-10 w-full">
          <div class="text-5xl group-hover:scale-110 transition-transform">
            {task.icon}
          </div>
          <span class={`text-xs font-black uppercase tracking-widest px-3 py-1.5 border-2 border-black ${style.bg} ${style.text} shadow-[2px_2px_0px_#000]`}>
            {style.label}
          </span>
        </div>
        
        <h3 class="font-black text-2xl text-black mb-4 uppercase tracking-tighter">
          {task.title}
        </h3>
        
        <p class="text-black font-bold text-base mb-8 line-clamp-2 leading-relaxed flex-grow">
          {task.scenario}
        </p>
        
        <div class="flex items-center justify-between mt-auto pt-6 border-t-4 border-black relative z-10">
          <span class="text-xs font-black text-black tracking-widest truncate pr-4 uppercase">
            // {task.learningPoint?.substring(0, 35)}...
          </span>
          
          <div class="text-black group-hover:bg-[#FF4911] group-hover:text-white border-2 border-transparent group-hover:border-black p-1 transition-colors">
            <svg class="w-6 h-6 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M14 5l7 7m0 0l-7 7m7-7H3"></path></svg>
          </div>
        </div>
      </a>
    );
  })}
</div>

<!-- Coming Soon Teaser -->
<div class="mt-16 bg-[#FF4911] border-4 border-black p-10 md:p-14 text-center shadow-[12px_12px_0px_#000]">
  <div class="relative z-10 max-w-2xl mx-auto">
    <div class="inline-flex items-center justify-center px-4 py-2 border-4 border-black bg-white text-black mb-8 font-black text-xl tracking-widest uppercase shadow-[4px_4px_0px_#000]">
      SYS_UP
    </div>
    <h3 class="font-black text-4xl md:text-5xl mb-6 text-white uppercase tracking-tighter drop-shadow-[4px_4px_0px_#000]">Sustav u razvoju</h3>
    <p class="text-white text-xl font-bold mb-10 leading-relaxed max-w-xl mx-auto">
      AI kontinuirano generira nove module na temelju globalne analize podataka. Procesiranje novih sektora u tijeku.
    </p>
    
    <div class="flex flex-wrap gap-4 justify-center">
      {['JEZIK', 'FINANCIJE', 'LOGISTIKA', 'ZDRAVLJE', 'KREATIVA'].map(tag => (
        <span class="bg-black text-white border-2 border-white px-4 py-2 font-black text-xs uppercase tracking-widest hover:bg-white hover:text-black hover:border-black transition-colors shadow-[2px_2px_0px_#fff]">
          [{tag}]
        </span>
      ))}
    </div>
  </div>
</div>
